// ===================== Snowflake 20x20 ======================

byte pict2[] = {
  0,9,45,82,105,0,10,45,82,105,1,9,84,126,147,1,10,84,126,147,2,3,14,17,20,2,8,66,75,81,2,9,181,223,251,2,10,181,223,251,2,11,66,75,81,2,16,14,17,20,3,2,16,20,23,3,3,126,158,179,3,4,33,37,38,3,9,74,120,149,3,10,74,120,149,3,15,33,37,38,3,16,126,158,179,3,17,16,20,23,4,3,40,44,47,4,4,155,166,174,4,5,24,34,41,4,6,9,18,25,4,9,92,132,163,4,10,92,132,163,4,13,26,25,25,4,14,35,39,41,4,15,155,166,174,4,16,40,44,47,5,4,43,48,48,5,5,194,250,255,5,6,90,153,185,5,8,39,49,69,5,9,153,198,239,5,10,153,198,239,5,11,39,49,69,5,13,159,180,185,5,14,197,252,255,5,15,31,43,48,6,4,33,33,33,6,5,162,185,201,6,6,96,140,170,6,7,32,40,43,6,9,95,134,176,6,10,95,134,176,6,12,33,40,43,6,13,98,141,170,6,14,93,159,202,6,15,13,25,33,7,6,40,50,54,7,7,99,119,137,7,8,54,92,143,7,9,82,161,245,7,10,82,161,245,7,11,54,92,143,7,12,99,119,137,7,13,40,50,54,8,2,63,73,78,8,4,10,13,19,8,5,39,49,68,8,7,55,94,145,8,8,51,148,224,8,9,0,101,159,8,10,0,101,159,8,11,51,148,224,8,12,55,94,145,8,14,39,50,68,8,15,10,13,19,8,17,63,73,78,9,0,43,77,101,9,1,82,121,146,9,2,180,221,233,9,3,67,110,137,9,4,92,130,157,9,5,149,192,220,9,6,92,131,170,9,7,81,159,230,9,8,0,101,160,9,9,63,147,196,9,10,63,147,196,9,11,0,101,160,9,12,81,159,230,9,13,92,131,170,9,14,149,192,220,9,15,92,130,157,9,16,67,110,137,9,17,180,221,233,9,18,82,121,146,9,19,43,77,101,10,0,49,88,114,10,1,92,135,163,10,2,181,225,236,10,3,75,123,153,10,4,100,142,171,10,5,155,199,225,10,6,99,142,183,10,7,81,160,229,10,8,0,99,159,10,9,72,152,200,10,10,72,152,200,10,11,0,99,159,10,12,81,160,229,10,13,99,142,183,10,14,155,199,225,10,15,100,142,171,10,16,75,123,153,10,17,181,225,236,10,18,92,135,163,10,19,49,88,114,11,2,75,86,93,11,4,12,16,23,11,5,46,59,81,11,6,6,7,13,11,7,56,98,153,11,8,46,146,220,11,9,0,100,158,11,10,0,100,158,11,11,46,146,220,11,12,56,98,153,11,13,6,7,13,11,14,47,59,81,11,15,12,16,23,11,17,75,86,93,12,6,37,45,47,12,7,96,116,135,12,8,59,101,157,12,9,75,158,241,12,10,75,158,241,12,11,59,101,157,12,12,96,116,135,12,13,37,45,47,13,4,30,30,30,13,5,147,167,181,13,6,94,136,163,13,7,42,51,56,13,9,96,136,180,13,10,96,136,180,13,12,43,52,56,13,13,93,135,163,13,14,82,142,181,13,15,12,23,30,14,4,41,45,43,14,5,204,255,255,14,6,94,160,185,14,8,36,46,64,14,9,149,193,234,14,10,149,193,234,14,11,36,46,64,14,13,162,186,185,14,14,177,251,255,14,15,20,37,43,15,3,31,34,35,15,4,152,164,172,15,5,34,49,58,15,6,14,28,36,15,9,101,142,174,15,10,101,142,174,15,13,37,37,37,15,14,41,51,58,15,15,150,162,172,15,16,31,34,35,16,2,15,19,22,16,3,127,158,179,16,4,45,49,52,16,9,66,111,140,16,10,66,111,140,16,15,45,49,52,16,16,127,158,179,16,17,15,19,22,17,3,23,29,33,17,8,66,75,81,17,9,180,222,251,17,10,180,222,251,17,11,66,75,81,17,16,23,29,33,18,9,91,131,154,18,10,91,131,154,19,9,51,92,119,19,10,51,92,119
};

//
//
void Neomatrix_scroll_picture2(byte xoffset, byte pic_row, byte pic_col, int delayms) {

  ArduinoOTA.handle();
   
  byte x, y, red, green, blue;
  uint16_t mcolor1;

  int pixel_num = sizeof(pict2)/5;
  matrix.setBrightness(55);

  byte nscroll = 0;
  for (byte mm = 0 ; mm < pic_row + 9  ; mm++) {  // to scroll all the picture + 9
    matrix.fillScreen(0); 
     
    for (int nn = 0 ; nn < pixel_num ; nn++) {
      x = pict2[nn*5] + xoffset;
      y = pict2[nn*5+1] - nscroll + 8;
    
      if (y > -1 && y < 8) {
        red = pict2[nn*5+2];
        green = pict2[nn*5+3];
        blue = pict2[nn*5+4];

        mcolor1 = matrix.Color(red,green,blue);
        matrix.drawPixel(x, y, mcolor1); 
        //Serial.println(x);
        //delay(1);
      }
    }
    delay(delayms);
    //delay(100);
    matrix.show();
    nscroll = (nscroll + 1); // % (pic_row+4);
  }
}

// ========================== Vertical Scroll Down ==========================================

void Neomatrix_scroll_picture_down(byte xoffset, byte pic_row, byte pic_col, int delayms) {
  ArduinoOTA.handle();
  
  byte x, y, red, green, blue;
  uint16_t mcolor1;

  int pixel_num = sizeof(pict2)/5;
  matrix.setBrightness(55);

  byte nscroll = pic_row+8;
  for (byte mm = 0 ; mm < pic_row + 9  ; mm++) {  // to scroll all the picture + 9
    matrix.fillScreen(0); 
     
    for (int nn = 0 ; nn < pixel_num ; nn++) {
      x = pict2[nn*5] + xoffset;
      y = pict2[nn*5+1] - nscroll + 8;
    
      if (y > -1 && y < 8) {
        red = pict2[nn*5+2];
        green = pict2[nn*5+3];
        blue = pict2[nn*5+4];

        mcolor1 = matrix.Color(red,green,blue);
        matrix.drawPixel(x, y, mcolor1); 
        //Serial.println(x);
        //delay(1);
      }
    }
    delay(delayms);
    //delay(100);
    matrix.show();
    nscroll = (nscroll - 1);
  }
}

// ============================ Random Colors ==================================

void Neomatrix_scroll_picture_random_color(byte xoffset, byte pic_row, byte pic_col, int delayms) {

  int randn = random(0,767);
  byte x, y, red, green, blue;
  uint16_t mcolor1;

  int pixel_num = sizeof(pict2)/5;
  matrix.setBrightness(55);

  if (randn < 256) {
      red = 255 - randn;
      green = randn;
  } else if (randn < 511) {
      green = 511 - randn;
      blue = randn - 256;
  } else {
      red = 767 - randn;
      blue = randn - 512;
  }

  byte nscroll = 0;
  for (byte mm = 0 ; mm < pic_row + 9  ; mm++) {  // to scroll all the picture + 9
    matrix.fillScreen(0); 
     
    for (int nn = 0 ; nn < pixel_num ; nn++) {
      x = pict2[nn*5] + xoffset;
      y = pict2[nn*5+1] - nscroll + 8;
    
      if (y > -1 && y < 8) {
       // red = pict2[nn*5+2];
     //   green = pict2[nn*5+3];
      //  blue = pict2[nn*5+4];

        mcolor1 = matrix.Color(red,green,blue);
        matrix.drawPixel(x, y, mcolor1); 
        //Serial.println(x);
        //delay(1);
      }
    }
    delay(delayms);
    //delay(100);
    matrix.show();
    nscroll = (nscroll + 1); // % (pic_row+4);
  }
}
